<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Player</title>
  <link rel="stylesheet" href="../styles.css">
  <script src="../scripts/jquery-3.7.1.min.js"></script>
</head>

<body>
  <div id="info">
    <div id="players" class="in4" style="width:500px">
      <p style="font-size: 15pt;">NC1 & NC2</p>
    </div>
    <div id="blank" class="in4" style="width:1000px"></div>
    <div id="qnumber" class="in4" style="width:100px">
      <p style="font-size: 15pt;">Câu</p>
    </div>
    <div id="category" class="in4" style="width:200px">
      <p style="font-size: 15pt;">CĐ</p>
    </div>
    <div id="money" class="in4" style="width:200px">
      <p style="font-size: 15pt;" id="remainMoneyText">200<span>.000.000 đồng</span></p>
    </div>
    <div id="timer" class="in4" style="width:75px">
      <p style="font-size: 15pt;">60</p>
    </div>
  </div>
  <div style="text-align: center; border:3px solid white">
    <p id="q">CH</p>
  </div>
  <div id="ans">
    <div id="a1" class="a">
      <p>a1</p>
    </div>
    <div id="a2" class="a">
      <p>a2</p>
    </div>
    <div id="a3" class="a">
      <p>a3</p>
    </div>
    <div id="a4" class="a">
      <p>a4</p>
    </div>
  </div>
  <div id="moneyContainer">
    <div id="money1" class="money">
      <p style="font-size:15pt;color:black;margin:0" id="money1text">0<span> đồng</span></p>
    </div>
    <div id="money2" class="money">
      <p style="font-size:15pt;color:black;margin:0" id="money2text">0<span> đồng</span></p>
    </div>
    <div id="money3" class="money">
      <p style="font-size:15pt;color:black;margin:0" id="money3text">0<span> đồng</span></p>
    </div>
    <div id="money4" class="money">
      <p style="font-size:15pt;color:black;margin:0" id="money4text">0<span> đồng</span></p>
    </div>

  </div>
  <div id="plusandminus">
    <button id="plus1">+</button>
    <button id="minus1">-</button>
    <button id="plus2">+</button>
    <button id="minus2">-</button>
    <button id="plus3">+</button>
    <button id="minus3">-</button>
    <button id="plus4">+</button>
    <button id="minus4">-</button>
  </div>
  <script src="/socket.io/socket.io.js"></script>
  <script>
    const playerSocket = io('/player')

    let money1 = 0
    let money2 = 0
    let money3 = 0
    let money4 = 0
    let remainMoney = 200
    let currentMoneyIn60s = remainMoney

    let money1para = document.getElementById('money1text')
    let money2para = document.getElementById('money2text')
    let money3para = document.getElementById('money3text')
    let money4para = document.getElementById('money4text')
    let remainMoneyPara = document.getElementById('remainMoneyText')

    let plus1btn = document.getElementById('plus1')
    let plus2btn = document.getElementById('plus2')
    let plus3btn = document.getElementById('plus3')
    let plus4btn = document.getElementById('plus4')
    let minus1btn = document.getElementById('minus1')
    let minus2btn = document.getElementById('minus2')
    let minus3btn = document.getElementById('minus3')
    let minus4btn = document.getElementById('minus4')

    function disableAllButtons() {
      plus1btn.disabled = true
      plus2btn.disabled = true
      plus3btn.disabled = true
      plus4btn.disabled = true
      minus1btn.disabled = true
      minus2btn.disabled = true
      minus3btn.disabled = true
      minus4btn.disabled = true
    }
    function enableAllButtons() {
      plus1btn.disabled = false
      plus2btn.disabled = false
      plus3btn.disabled = false
      plus4btn.disabled = false
      minus1btn.disabled = false
      minus2btn.disabled = false
      minus3btn.disabled = false
      minus4btn.disabled = false
    }

    function disableAns4() {
      $('#a4').css('opacity', '0')
      $('#money4').css('opacity', '0')
      $('#plus4').css('opacity', '0')
      $('#minus4').css('opacity', '0')
    }
    function disableAns1() {
      $('#a1').css('opacity', '0')
      $('#money1').css('opacity', '0')
      $('#plus1').css('opacity', '0')
      $('#minus1').css('opacity', '0')
    }

    function changeMoney(operation, ansPosition) {
      if (operation == "+") {
        if (ansPosition == 1) {
          money1 += 5
          if (money1 == 0) {
            money1para.innerHTML = '0<span> đồng</span>'
          }
          else {
            money1para.innerHTML = `${money1}<span>.000.000 đồng</span>`
          }
        }
        if (ansPosition == 2) {
          money2 += 5
          if (money2 == 0) {
            money2para.innerHTML = '0<span> đồng</span>'
          }
          else {
            money2para.innerHTML = `${money2}<span>.000.000 đồng</span>`
          }
        }
        if (ansPosition == 3) {
          money3 += 5
          if (money3 == 0) {
            money3para.innerHTML = '0<span> đồng</span>'
          }
          else {
            money3para.innerHTML = `${money3}<span>.000.000 đồng</span>`
          }
        }
        if (ansPosition == 4) {
          money4 += 5
          if (money4 == 0) {
            money4para.innerHTML = '0<span> đồng</span>'
          }
          else {
            money4para.innerHTML = `${money4}<span>.000.000 đồng</span>`
          }
        }
        if (ansPosition == "remain") {
          currentMoneyIn60s += 5
          if (currentMoneyIn60s == 0) {
            remainMoneyPara.innerHTML = '0<span> đồng</span>'
          }
          else {
            remainMoneyPara.innerHTML = `${currentMoneyIn60s}<span>.000.000 đồng</span>`
          }
        }
      }

      else if (operation == "-") {
        if (ansPosition == 1) {
          money1 -= 5
          if (money1 == 0) {
            money1para.innerHTML = '0<span> đồng</span>'
          }
          else {
            money1para.innerHTML = `${money1}<span>.000.000 đồng</span>`
          }
        }
        if (ansPosition == 2) {
          money2 -= 5
          if (money2 == 0) {
            money2para.innerHTML = '0<span> đồng</span>'
          }
          else {
            money2para.innerHTML = `${money2}<span>.000.000 đồng</span>`
          }
        }
        if (ansPosition == 3) {
          money3 -= 5
          if (money3 == 0) {
            money3para.innerHTML = '0<span> đồng</span>'
          }
          else {
            money3para.innerHTML = `${money3}<span>.000.000 đồng</span>`
          }
        }
        if (ansPosition == 4) {
          money4 -= 5
          if (money4 == 0) {
            money4para.innerHTML = '0<span> đồng</span>'
          }
          else {
            money4para.innerHTML = `${money4}<span>.000.000 đồng</span>`
          }
        }
        if (ansPosition == "remain") {
          currentMoneyIn60s -= 5
          if (currentMoneyIn60s == 0) {
            remainMoneyPara.innerHTML = '0<span> đồng</span>'
          }
          else {
            remainMoneyPara.innerHTML = `${currentMoneyIn60s}<span>.000.000 đồng</span>`
          }
        }
      }
    }

    plus1btn.addEventListener('click', () => { playerSocket.emit('plus1') })
    plus2btn.addEventListener('click', () => { playerSocket.emit('plus2') })
    plus3btn.addEventListener('click', () => { playerSocket.emit('plus3') })
    plus4btn.addEventListener('click', () => { playerSocket.emit('plus4') })
    minus1btn.addEventListener('click', () => { playerSocket.emit('minus1') })
    minus2btn.addEventListener('click', () => { playerSocket.emit('minus2') })
    minus3btn.addEventListener('click', () => { playerSocket.emit('minus3') })
    minus4btn.addEventListener('click', () => { playerSocket.emit('minus4') })

    playerSocket.on('plus1', () => {
      changeMoney("+", 1)
      changeMoney("-", "remain")
    })
    playerSocket.on('plus2', () => {
      changeMoney("+", 2)
      changeMoney("-", "remain")
    })
    playerSocket.on('plus3', () => {
      changeMoney("+", 3)
      changeMoney("-", "remain")
    })
    playerSocket.on('plus4', () => {
      changeMoney("+", 4)
      changeMoney("-", "remain")
    })
    playerSocket.on('minus1', () => {
      changeMoney("-", 1)
      changeMoney("+", "remain")
    })
    playerSocket.on('minus2', () => {
      changeMoney("-", 2)
      changeMoney("+", "remain")
    })
    playerSocket.on('minus3', () => {
      changeMoney("-", 3)
      changeMoney("+", "remain")
    })
    playerSocket.on('minus4', () => {
      changeMoney("-", 4)
      changeMoney("+", "remain")
    })
    playerSocket.on('disable 4', () => disableAns4())
    playerSocket.on('disable 1', () => disableAns1())
  </script>
</body>

</html>